機能仕様書 (Functional Specifications)
1. 概要
本ドキュメントは「Smart Schedule (仮)」の具体的な機能の振る舞い、画面構成、およびAPIの仕様について定義する。対象はMVP (Phase 1) とする。

2. システム構成
フロントエンド: React (SPA)
バックエンド: FastAPI (REST API)
データベース: PostgreSQL

3. 画面遷移とUI構成
3.1 画面一覧
イベント回答画面 (メイン画面) /event/{event_id}
イベントの詳細（タイトル、期間）を表示。
自身の回答入力フォーム（ユーザー名入力、各日程の◯/△/✕選択、コメント入力）。
【アクション】「回答を送信する」ボタン
集計・一覧画面 /event/{event_id}/summary
ベスト日程のレコメンド表示（スコア順位）。
全参加者の回答マトリクス表。

3.2 画面遷移図
[アクセス] 
   │ (localStorageでUUID確認。無ければ生成)
   ▼
[イベント回答画面] ──(回答送信)──▶ [集計・一覧画面]
   ▲                                  │
   └───────────(回答を修正)───────────┘



4. 機能詳細
4.1 簡易ID管理機能 (Fingerprinting)
トリガー: ユーザーがアプリケーションに初回アクセスした時。
処理: 1. フロントエンドで crypto.randomUUID() を用いてUUIDを生成。
2. 生成したUUIDを localStorage.setItem('device_uuid', uuid) で保存。
3. 以降のAPIリクエスト時、HTTPヘッダー X-Device-UUID にこの値を含めて送信。
エラー処理: ブラウザのシークレットモード等で localStorage が使えない場合、メモリ上でUUIDを保持する（タブを閉じると回答の編集権限は失われる旨を画面に警告表示）。

4.2 回答登録機能
入力項目:
ユーザー名 (必須, 最大50文字)
各日程のステータス (必須, 列挙型: AVAILABLE(2), ADJUSTABLE(1), IMPOSSIBLE(0))
コメント (任意, ADJUSTABLE の場合は入力を強く推奨)
処理手順:
フロントエンドからAPIへ回答データ(JSON)とUUIDをPOST送信。
バックエンドはUUIDをキーに既存ユーザーか新規ユーザーか判定。
回答データをデータベース(Answersテーブル)にUpsert（存在すれば更新、なければ挿入）する。
入力バリデーション:
ユーザー名が空の場合はエラー。
存在しないイベントID、日程IDが指定された場合は404エラー。

4.3 レコメンド・一覧表示機能 (アルゴリズム)
処理:
APIエンドポイント /api/events/{event_id}/summary にGETリクエスト。
バックエンドは当該イベントの全回答データを取得。
各日程に対して以下の計算式でスコアを算出。
スコア = (AVAILABLEの数 * 2) + (ADJUSTABLEの数 * 1)
日程をスコアの降順でソート。スコアが同点の場合は、早い日付順とする。
ソートされた日程リストと、マトリクス表示用の回答データをフロントエンドに返却。
表示: 1位〜3位までの日程を「おすすめ日程」としてハイライト表示する。
5. 異常系・エラー処理
| エラー状況 | バックエンドの挙動 (HTTP Status) | フロントエンドの挙動 (UI表示) |
| 必須パラメータ不足 | 422 Unprocessable Entity (FastAPI自動処理) | 入力フォームに赤字でエラーメッセージを表示。 |
| 存在しないイベントへのアクセス | 404 Not Found | 「イベントが見つかりません」という専用のエラー画面を表示。 |
| 他人の回答を編集・削除しようとした | 403 Forbidden | 「権限がありません」とトースト通知を表示。 |
| DB接続エラー等（サーバー内部エラー） | 500 Internal Server Error | 「システムエラーが発生しました。時間をおいて再試行してください」と表示。 |
